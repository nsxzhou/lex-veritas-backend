# LexVeritas Backend Configuration
# 环境变量格式: LEXVERITAS_<SECTION>_<KEY> (例如: LEXVERITAS_SERVER_PORT=8080)

server:
  name: "lex-veritas-backend"
  port: 8080
  mode: "debug" # debug | release | test
  read_timeout: 30s
  write_timeout: 30s

log:
  level: "info" # debug | info | warn | error
  format: "console" # json | console
  output: "stdout" # stdout | file
  file_path: "./logs/app.log"
  max_size: 100 # MB
  max_backups: 7
  max_age: 30 # days

database:
  host: "localhost" # 使用环境变量: LEXVERITAS_DATABASE_HOST
  port: 5432 # 使用环境变量: LEXVERITAS_DATABASE_PORT
  user: "root" # 使用环境变量: LEXVERITAS_DATABASE_USER
  password: "root" # 使用环境变量: LEXVERITAS_DATABASE_PASSWORD
  dbname: "lexveritas" # 使用环境变量: LEXVERITAS_DATABASE_NAME
  sslmode: "disable"
  max_open_conns: 100
  max_idle_conns: 10
  conn_max_lifetime: 1h
  conn_max_idle_time: 10m

redis:
  host: "localhost" # 使用环境变量: LEXVERITAS_REDIS_HOST
  port: 6379 # 使用环境变量: LEXVERITAS_REDIS_PORT
  password: "" # 使用环境变量: LEXVERITAS_REDIS_PASSWORD
  db: 1
  pool_size: 100
  min_idle_conns: 10
  dial_timeout: 5s
  read_timeout: 3s
  write_timeout: 3s

milvus:
  host: "localhost" # 本地 Milvus 使用 localhost，Zilliz Cloud 使用完整 URL 如 https://xxx.zillizcloud.com
  port: 19530 # 本地使用 19530，Zilliz Cloud 不需要（使用环境变量: LEXVERITAS_MILVUS_PORT）
  collection_name: "legal_knowledge"
  dimension: 4096
  api_key: "" # Zilliz Cloud API Key（使用环境变量: LEXVERITAS_MILVUS_API_KEY）
  use_cloud: false # 是否使用 Zilliz Cloud（使用环境变量: LEXVERITAS_MILVUS_USE_CLOUD）

jwt:
  secret: "" # 使用环境变量: LEXVERITAS_JWT_SECRET
  access_expire: 60m
  refresh_expire: 168h # 7 days
  issuer: "lex-veritas"

auth:
  bcrypt_cost: 12
  max_login_attempts: 5
  lockout_duration: 15m

cors:
  allowed_origins:
    - "http://localhost:3000"
    - "http://localhost:5173"
  allowed_methods:
    - "GET"
    - "POST"
    - "PUT"
    - "DELETE"
    - "OPTIONS"
  allowed_headers:
    - "Origin"
    - "Content-Type"
    - "Authorization"
  max_age: 12h

ratelimit:
  enabled: true
  rate: 100 # 每秒请求数
  burst: 200 # 突发容量

quota:
  default_token_quota: 100000 # 新用户默认 Token 额度
  guest_max_sessions: 1 # 匿名用户最大会话数
  guest_max_chats: 5 # 匿名用户每会话最大对话数
  guest_session_ttl: 24h # 匿名会话过期时间

email:
  provider: "smtp" # smtp | resend 使用环境变量：LEXVERITAS_EMAIL_PROVIDER
  smtp_host: "smtp.qq.com" # 使用环境变量: LEXVERITAS_EMAIL_SMTP_HOST
  smtp_port: 465 # 使用环境变量: LEXVERITAS_EMAIL_SMTP_PORT (QQ邮箱SSL端口)
  smtp_user: "" # 使用环境变量: LEXVERITAS_EMAIL_SMTP_USER
  smtp_password: "" # 使用环境变量: LEXVERITAS_EMAIL_SMTP_PASSWORD
  from_address: "1790146932@qq.com"
  from_name: "LexVeritas"
  resend_api_key: "" # 使用环境变量: LEXVERITAS_EMAIL_RESEND_API_KEY

verification:
  code_length: 6
  code_expire: 5m
  resend_delay: 60s
  max_attempts: 5
