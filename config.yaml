# LexVeritas Backend Configuration
# 环境变量格式: LEXVERITAS_<SECTION>_<KEY> (例如: LEXVERITAS_SERVER_PORT=8080)

server:
  name: "lex-veritas-backend"
  port: 8080
  mode: "debug" # debug | release | test
  read_timeout: 30s
  write_timeout: 30s

log:
  level: "info" # debug | info | warn | error
  format: "json" # json | console
  output: "stdout" # stdout | file
  file_path: "./logs/app.log"
  max_size: 100 # MB
  max_backups: 7
  max_age: 30 # days

database:
  host: "localhost"
  port: 5432
  user: "lexveritas"
  password: "" # 使用环境变量: LEXVERITAS_DATABASE_PASSWORD
  dbname: "lexveritas"
  sslmode: "disable"
  max_open_conns: 100
  max_idle_conns: 10
  conn_max_lifetime: 1h
  conn_max_idle_time: 10m

redis:
  host: "localhost"
  port: 6379
  password: "" # 使用环境变量: LEXVERITAS_REDIS_PASSWORD
  db: 0
  pool_size: 100
  min_idle_conns: 10
  dial_timeout: 5s
  read_timeout: 3s
  write_timeout: 3s

milvus:
  host: "localhost"
  port: 19530
  collection_name: "legal_knowledge"
  dimension: 1536

jwt:
  secret: "" # 使用环境变量: LEXVERITAS_JWT_SECRET
  access_expire: 15m
  refresh_expire: 168h # 7 days
  issuer: "lex-veritas"

auth:
  bcrypt_cost: 12
  max_login_attempts: 5
  lockout_duration: 15m

cors:
  allowed_origins:
    - "http://localhost:3000"
    - "http://localhost:5173"
  allowed_methods:
    - "GET"
    - "POST"
    - "PUT"
    - "DELETE"
    - "OPTIONS"
  allowed_headers:
    - "Origin"
    - "Content-Type"
    - "Authorization"
  max_age: 12h

ratelimit:
  enabled: true
  rate: 100 # 每秒请求数
  burst: 200 # 突发容量

quota:
  default_token_quota: 100000 # 新用户默认 Token 额度
  guest_max_sessions: 1 # 匿名用户最大会话数
  guest_max_chats: 5 # 匿名用户每会话最大对话数
  guest_session_ttl: 24h # 匿名会话过期时间

email:
  provider: "smtp" # smtp | resend
  smtp_host: "smtp.qq.com"
  smtp_port: 587
  smtp_user: "" # 使用环境变量: LEXVERITAS_EMAIL_SMTP_USER
  smtp_password: "" # 使用环境变量: LEXVERITAS_EMAIL_SMTP_PASSWORD
  from_address: "noreply@example.com"
  from_name: "LexVeritas"
  resend_api_key: "" # 使用环境变量: LEXVERITAS_EMAIL_RESEND_API_KEY

verification:
  code_length: 6
  code_expire: 5m
  resend_delay: 60s
  max_attempts: 5
